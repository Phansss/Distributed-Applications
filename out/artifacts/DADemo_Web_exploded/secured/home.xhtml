<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
   <title>Main Page</title>
   <h:outputStylesheet library = "css" name = "styles.css"  />
</h:head>

<h:body style="margin: 0" class="background">

   <div class="header">
      <h1 style="align-self: center; margin: 0;">Rate Your Professor by P&amp;D</h1>

      <h:outputText style="align-self: right" value="Welcome #{homeScreenBean.userFullName}"/>
   </div>

   <div class="row">
      <div class="left">
         <div class="sticky">
            <br/>
            <div class="margin-10-left white-background sticky">

               <h1>Your Courses</h1>

               <h:form > <!-- A menu has to be inside a form tag because it has implementations for action selection -->
                  <p:menu id="courseMenuModel" model="#{homeScreenBean.menuModel}" toggleable="true">
                     <p:autoUpdate/>
                  </p:menu>
               <!--
            <h:form>


                  <p:selectManyMenu id="courseMenu" value="#{homeScreenBean.selectedCoursesAsStringArray}" label="Courses" style="width: 15rem"
                                        filter="true" filterMatchMode="startsWith" panelStyle="width: 15rem" scrollHeight="250"
                                        dynamic="true">
                     <f:selectItems value="#{homeScreenBean.coursesAsString}"/>
                  </p:selectManyMenu>
            </h:form>
               -->
               <h1>Add a course</h1>
                  <p:selectCheckboxMenu id="multiple" value="#{homeScreenBean.subscribedCourses}" filter="true"
                                        filterMatchMode="contains" label="Courses" updateLabel="true"
                                        style="min-width: 15rem" panelStyle="width: 30rem" scrollHeight="250" multiple="true">
                     <p:ajax event="change" listener="#{homeScreenBean.functionOnChange()}"/>
                     <f:selectItems value="#{homeScreenBean.courseEntities}"
                                    var="course"
                                    itemValue="#{course}"
                                    itemLabel="#{course.name}"
                                    itemLabelEscaped="true"/>
<!--                     <f:selectItems value="#{homeScreenBean.coursesAsString}"/>-->
                  </p:selectCheckboxMenu>
               </h:form>
               <h:form>
                  <h:commandButton action = "homeScreenBean" value = "Subscribe" actionListener="#{homeScreenBean.subscribe}"/>
               </h:form>
            </div>
         </div>
      </div>
      <div class="middle margin-10-left">
         <h1 class="text-on-background">Latest Comments</h1>

         <h:form id="repeatform">
            <p:autoUpdate/>
            <p:repeat value="#{homeScreenBean.RTCommentsToShow}" var="comment">

             <div class="commentBox white-background">
               <br/>
                  <b><h:outputText value="Sender: "/></b><h:outputText value="#{comment.madeBy.name} #{comment.madeBy.lastName}"/>
                  <br/><br/>
                  <b><h:outputText value="About: "/></b><h:outputText value="#{comment.isAbout.name}"/>
                  <br/><br/>
                  <b><h:outputText value="Rating: "/></b><h:outputText value="#{comment.rating}"/>
                  <br/><br/>
                  <h:outputText value="#{comment.text}"/>
                  <br/><br/>
                  <h:outputText class="timeText" value="Posted on: #{comment.timePosted}"/>
                  <br/>
               </div>
               <br/>
            </p:repeat>

            <p:repeat value="#{homeScreenBean.TCommentsToShow}" var="comment">
               <div class="commentBox white-background">
                  <br/>
                  <b><h:outputText value="Sender: "/></b><h:outputText value="#{comment.madeBy.name} #{comment.madeBy.lastName}"/>
                  <br/><br/>
                  <b><h:outputText value="About: "/></b><h:outputText value="#{comment.isAbout.name}"/>
                  <br/><br/>
                  <h:outputText value="#{comment.text}"/>
                  <br/><br/>
                  <h:outputText class="timeText" value="Posted on: #{comment.timePosted}"/>
                  <br/>
               </div>
               <br/>
            </p:repeat>

            <p:repeat value="#{homeScreenBean.RCommentsToShow}" var="comment">
               <div class="commentBox white-background">
                  <br/>
                  <b><h:outputText value="Sender: "/></b><h:outputText value="#{comment.madeBy.name} #{comment.madeBy.lastName}"/>
                  <br/><br/>
                  <b><h:outputText value="About: "/></b><h:outputText value="#{comment.isAbout.name}"/>
                  <br/><br/>
                  <b><h:outputText value="Rating: "/></b><h:outputText value="#{comment.rating}"/>
                  <br/><br/>
                  <h:outputText class="timeText" value="Posted on: #{comment.timePosted}"/>
                  <br/>
               </div>
               <br/>
            </p:repeat>

         </h:form>
      </div>
      <div class="right" >
         <div class="sticky">
            <br/>
            <div class="margin-10-right white-background">

               <h1>Make a new comment</h1>

               <h3>Text</h3>
               <h:form>
                  <h:inputTextarea value="#{homeScreenBean.text1}"/>

                  <br/><br/>

                  <h3>Rating</h3>
                  <p:rating value="#{homeScreenBean.rating}"/>

                  <br/><br/><br/><br/>

                  <h3>About Professor</h3>
                  <p:selectOneMenu id="professorsDropdown" value="#{homeScreenBean.chosenProfessor}">
                     <p:autoUpdate/>
                     <f:selectItems value="#{homeScreenBean.professorNames}"/>
                  </p:selectOneMenu>

                  <br/><br/><br/>

                  <h:commandButton action = "homeScreenBean" value = "Add Comment" actionListener="#{homeScreenBean.printRating()}"/><br/>
               </h:form>
            </div>
         </div>
      </div>
   </div>

</h:body>

</html>