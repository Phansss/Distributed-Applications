<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
   <title>Main Page</title>
   <h:outputStylesheet library = "css" name = "styles.css"  />
</h:head>

<h:body style="margin: 0" class="background">

   <div class="header">
      <h1 style="align-self: center; margin: 0;">Rate Your Professor by P&amp;D</h1>

      <h:outputText style="align-self: right" value="Welcome #{homeScreenBean.userFullName}"/>
   </div>

   <div class="row">
      <div class="left">
         <div class="sticky">
            <br/>
            <div class="margin-10-left white-background sticky">

               <h1>Your Courses</h1>

               <h:form > <!-- A menu has to be inside a form tag because it has implementations for action selection -->
                  <p:menu id="courseMenuModel" model="#{homeScreenBean.menumodel}">
                     <p:autoUpdate/>
                  </p:menu>

                  <h1>Add a course</h1>
                  <p:selectManyMenu id="courseMenu" value="#{homeScreenBean.selectedCoursesAsCourses}" converter="CourseConverter" var="c" filter="true" filterMatchMode="contains" showCheckbox="true" >
                     <f:selectItems  value="#{homeScreenBean.coursesAsCourses}" var="course" itemLabel="#{course.name}" itemValue="#{course}"/>
                     <!-- <p:ajax process="@this" event="click" listener="#{homeScreenBean.makeCourseMenuFake()}" update="courseMenuModel"/>
                     <p:ajax process="@this" event="change" listener="#{homeScreenBean.makeCourseMenuFake()}" update="courseMenuModel"/>
                     <p:ajax process="@this" event="dblclick" listener="#{homeScreenBean.makeCourseMenuFake()}" update="courseMenuModel"/>
                     <p:ajax process="@this" event="input" listener="#{homeScreenBean.makeCourseMenuFake()}" update="courseMenuModel"/>
                     <p:ajax process="@this" event="mouseup" listener="#{homeScreenBean.makeCourseMenuFake()}" update="courseMenuModel"/>-->
                  </p:selectManyMenu>


                  <h:outputText id="textfield" value="#{homeScreenBean.selectedCoursesAsString.size()} + #{homeScreenBean.coursesAsString.size()}">
                     <p:autoUpdate/>
                  </h:outputText>

                  <h:commandButton action = "#{homeScreenBean.makeCourseMenuFake()}" value = "ADD">
                     <p:ajax event="click" update="textfield"/>
                     <p:autoUpdate/>
                  </h:commandButton><br/>
               </h:form>



            </div>
         </div>
      </div>
      <div class="middle margin-10-left">
         <h1 class="text-on-background">Latest Comments</h1>

         <h:form>

            <p:repeat value="#{homeScreenBean.RTCommentsToShow}" var="comment">
             <div class="commentBox white-background">
               <br/>
                  <b><h:outputText value="Sender: "/></b><h:outputText value="#{comment.madeBy.name} #{comment.madeBy.lastName}"/>
                  <br/><br/>
                  <b><h:outputText value="About: "/></b><h:outputText value="#{comment.isAbout.name}"/>
                  <br/><br/>
                  <b><h:outputText value="Rating: "/></b><h:outputText value="#{comment.rating}"/>
                  <br/><br/>
                  <h:outputText value="#{comment.text}"/>
                  <br/><br/>
                  <h:outputText class="timeText" value="Posted on: #{comment.timePosted}"/>
                  <br/>
               </div>
               <br/>
            </p:repeat>

            <p:repeat value="#{homeScreenBean.TCommentsToShow}" var="comment">
               <div class="commentBox white-background">
                  <br/>
                  <b><h:outputText value="Sender: "/></b><h:outputText value="#{comment.madeBy.name} #{comment.madeBy.lastName}"/>
                  <br/><br/>
                  <b><h:outputText value="About: "/></b><h:outputText value="#{comment.isAbout.name}"/>
                  <br/><br/>
                  <h:outputText value="#{comment.text}"/>
                  <br/><br/>
                  <h:outputText class="timeText" value="Posted on: #{comment.timePosted}"/>
                  <br/>
               </div>
               <br/>
            </p:repeat>

            <p:repeat value="#{homeScreenBean.RCommentsToShow}" var="comment">
               <div class="commentBox white-background">
                  <br/>
                  <b><h:outputText value="Sender: "/></b><h:outputText value="#{comment.madeBy.name} #{comment.madeBy.lastName}"/>
                  <br/><br/>
                  <b><h:outputText value="About: "/></b><h:outputText value="#{comment.isAbout.name}"/>
                  <br/><br/>
                  <b><h:outputText value="Rating: "/></b><h:outputText value="#{comment.rating}"/>
                  <br/><br/>
                  <h:outputText class="timeText" value="Posted on: #{comment.timePosted}"/>
                  <br/>
               </div>
               <br/>
            </p:repeat>

         </h:form>
      </div>
      <div class="right" >
         <div class="sticky">
            <br/>
            <div class="margin-10-right white-background">

               <h1>Make a new comment</h1>

               <h3>Text</h3>
               <h:form>
                  <h:inputTextarea value="#{homeScreenBean.text1}">
                     <p:ajax event="keyup" update="textField" process="@this"/>
                  </h:inputTextarea>
                  <h:outputText id="textField" value="#{homeScreenBean.text1}"/>
               </h:form>
               <br/>
               <br/>

               <h3>Rating</h3>
               <p:rating value="#{homeScreenBean.rating}" onRate="alert('You rated: ' + value)">
                  <p:ajax event="rate" listener="#{homeScreenBean.handleRate}" update="msgs" />
                  <p:ajax event="cancel" listener="#{homeScreenBean.handleCancel}" update="msgs" />
               </p:rating>
               <p:messages id="msgs"/>
               <h:outputText id="ratingText" value="#{homeScreenBean.rating}">
                  <p:autoUpdate/>
               </h:outputText>
               <h:commandButton value = "UPDATE">
                  <p:ajax event="click" update="ratingText" listener="#{homeScreenBean.updateRating()}"/>
               </h:commandButton><br/>

               <br/>
               <br/>
               <br/>
               <br/>

               <h3>About Professor</h3>
               <p:selectOneMenu id="professorsDropdown" value="#{homeScreenBean.chosenProfessor}">
                  <f:selectItems value="#{homeScreenBean.allProfessorNames}"/>
                  <p:ajax event="change" update="chosenprofoutput"/>
               </p:selectOneMenu>

               <h:outputText id="chosenprofoutput" value="#{homeScreenBean.chosenProfessor}"/>

               <br/>
               <br/>
               <br/>

               <h:commandButton action = "home" value = "ADD"/><br/>

            </div>
         </div>
      </div>
   </div>

</h:body>

</html>